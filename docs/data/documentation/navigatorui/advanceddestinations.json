{"kind":"article","sections":[],"abstract":[{"text":"Building NavigationDestinations that access the environment and other use cases","type":"text"}],"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"text":"Overview","type":"heading"},{"inlineContent":[{"text":"Earlier we demonstrated how to provide ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/NavigationDestination"},{"text":" types with a view body that returns the correct view for that type.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["    ...","    case pageN(Int)","","    public var body: some View {","        switch self {","        case .page2:","            HomePage2View()","        case .page3:","            HomePage3View()","        ...","        }","    }","}"],"type":"codeListing"},{"inlineContent":[{"text":"It’s a powerful technique, but what if we can’t construct a specific view without external dependencies or without accessing the environment?","type":"text"}],"type":"paragraph"},{"anchor":"Destination-Views","level":3,"text":"Destination Views","type":"heading"},{"inlineContent":[{"text":"Simple. Just delegate the view building to a standard SwiftUI view!","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["    ...","    case pageN(Int)","","    public var body: some View {","        HomeDestinationsView(destination: self)","    }","}","","private struct HomeDestinationsView: View {","    let destination: HomeDestinations","    @Environment(\\.homeDependencies) var resolver","    var body: some View {","        switch self {","        case .home:","            HomePageView(viewModel: HomePageViewModel(dependencies: resolver))","        case .page2:","            HomePage2View(viewModel: HomePage2ViewModel(dependencies: resolver))","        case .page3:","            HomePage3View(viewModel: HomePage3ViewModel(dependencies: resolver))","        case .pageN(let value):","            HomePageNView(dependencies: resolver, number: value)","        case .external:","            resolver.externalView()","        }","    }","}"],"type":"codeListing"},{"inlineContent":[{"text":"In the above code, we obtain a ","type":"text"},{"type":"codeVoice","code":"homeDependencies"},{"text":" resolver from the environment and then use it to construct our views","type":"text"},{"text":" ","type":"text"},{"text":"and view models.","type":"text"}],"type":"paragraph"},{"anchor":"Passing-Dependencies","level":3,"text":"Passing Dependencies","type":"heading"},{"inlineContent":[{"text":"Note that some of the examples expose the view model to the caller, and that’s a practice I would generally argue against. The fact that a view has a view model (or not) is an implementation detail and should be private to the view itself.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Further, exposing the view model and its requirements complicates the call sites and really just kicks the can down the road. Sure, my VM gets its dependencies injected, but how does the ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"caller"}]},{"text":" get them to inject?","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"But creating a ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"private"}]},{"text":" destination view means that external dependency is never exposed to the outside world… and that tends to mitigate the problem in my book.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["case .page2:","    HomePage2View(viewModel: HomePage2ViewModel(dependencies: resolver))"],"type":"codeListing"},{"inlineContent":[{"text":"Sites specify the desired view using its enumerated value, but they never see the actual view, nor are they concerned with its requirements.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Alternatively, one could simply pass our environment-based dependency resolver to the view and let the view handle it as needed.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["case .pageN(let value):","    HomePageNView(dependencies: resolver, number: value)","","struct HomePageNView: View {","    @StateObject private var viewModel: HomePageNViewModel","    init(dependencies: HomeDependencies, number: Int) {","        self._viewModel = .init(wrappedValue: .init(dependencies: dependencies, number: number))","    }","    var body: some View {","        ...","    }","}"],"type":"codeListing"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"See the ‘DemoDependency.swift’ file in the NavigatorDemo project for a possible dependency injection mechanism."}],"type":"emphasis"}],"type":"paragraph"},{"anchor":"NavigationDestinations-within-Views","level":3,"text":"NavigationDestinations within Views","type":"heading"},{"inlineContent":[{"type":"text","text":"This technique also allows us to construct and use fully functional views elsewhere in our view code. Consider."}],"type":"paragraph"},{"syntax":"swift","code":["struct RootHomeView: View {","    var body: some View {","        ManagedNavigationStack {","            HomeDestinations.home","                .navigationDestination(HomeDestinations.self)","        }","    }","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Remember, our enumerated values are Views! Just drop the value into a view to obtain a fully resolved "},{"type":"codeVoice","code":"HomePageView"},{"type":"text","text":" and view model from "},{"type":"codeVoice","code":"HomeDestinationsView"},{"type":"text","text":","},{"type":"text","text":" "},{"type":"text","text":"complete and ready to go."}],"type":"paragraph"},{"anchor":"Custom-Sheets-using-NavigationDestination","level":3,"text":"Custom Sheets using NavigationDestination","type":"heading"},{"inlineContent":[{"type":"text","text":"Let’s demonstrate that again using a custom presentation mechanism with detents."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Only this time instead of evaluating the enumerated value directly we’ll do the same using a destination variable."}],"type":"paragraph"},{"syntax":"swift","code":["struct CustomSheetView: View {","    @State private var showSettings: SettingsDestinations?","    var body: some View {","        List {","            Button(\"Present Page 2 via Sheet\") {","                showSettings = .page2","            }","            Button(\"Present Page 3 via Sheet\") {","                showSettings = .page3","            }","            .sheet(item: $showSettings) { destination in","                destination \/\/ obtain view","                    .presentationDetents([.medium, .large])","                    .presentationDragIndicator(.visible)","                    .navigationDismissible()","            }","        }","    }","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Setting the variable passes the desired destination to the sheet closure via the "},{"type":"codeVoice","code":"$showSettings"},{"type":"text","text":" binding. Which again allows us to directly evaluate the value and obtain a fully resolved view ready for presentation."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Note that the "},{"type":"codeVoice","code":".navigationDismissible()"},{"type":"text","text":" modifier “registers” our custom sheet with Navigator, and allows the view to be dismissed as needed when deep links and routing occurs elsewhere in the application. (See: "},{"identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/Dismissible","isActive":true,"type":"reference"},{"type":"text","text":".)"}],"type":"paragraph"},{"type":"heading","level":3,"anchor":"Modular-Views","text":"Modular Views"},{"inlineContent":[{"text":"We can also use this technique to expose a module’s feature views ","type":"text"},{"inlineContent":[{"type":"text","text":"without"}],"type":"emphasis"},{"type":"text","text":" exposing exposing the views themselves. Consider."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["public enum OrderDestinations: NavigationDestination {","    case orderSummaryCard(Order)","    case order(Item)","    case listPastOrders","","    public var body: some View {","        OrderDestinationsView(destination: self)","    }","}"]},{"inlineContent":[{"type":"text","text":"Again, this lets us obtain and use fully constructed views from a module "},{"type":"emphasis","inlineContent":[{"type":"text","text":"without"}]},{"type":"text","text":" seeing the actual views that support them, and "},{"type":"emphasis","inlineContent":[{"type":"text","text":"without"}]},{"type":"text","text":" knowing any details of how they’re constructed."}],"type":"paragraph"},{"type":"codeListing","code":["struct CustomView: View {","    @Environment(\\.navigator) var navigator","    @State var order: Order","    var body: some View {","        VStack {","            ...","            OrderDestinations.orderSummaryCard(order)","            ...","        }","    }","}"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"And now the order summary card is in our view, doing it’s thing."}]},{"inlineContent":[{"type":"text","text":"Couple that with Navigator 1.2’s ability to avoid the need for "},{"type":"codeVoice","code":"navigationDestination"},{"type":"text","text":" registrations, and you have an extremely powerful system at your command."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"If the "},{"type":"codeVoice","code":"orderSummaryCard"},{"type":"text","text":" has a button that takes them to an internal "},{"type":"codeVoice","code":"OrderSummaryDetails"},{"type":"text","text":" page, that’s fine."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"It just works."}],"type":"paragraph"},{"anchor":"Cross-Module-View-Dependencies","level":3,"text":"Cross Module View Dependencies","type":"heading"},{"inlineContent":[{"type":"text","text":"Another technique that might not be apparent is how this gives us the ability to pass required views across features."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Take another look at our original "},{"type":"codeVoice","code":"HomeDestinationsView"},{"type":"text","text":"."}],"type":"paragraph"},{"type":"codeListing","code":["private struct HomeDestinationsView: View {","    let destination: HomeDestinations","    @Environment(\\.homeDependencies) var resolver","    var body: some View {","        switch self {","        ...","        case .external:","            resolver.externalView()","        }","    }","}"],"syntax":"swift"},{"inlineContent":[{"type":"text","text":"Note how our feature get an externally provided view from our dependency resolver."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The Home feature doesn’t know what module or feature provided the view. Nor should it care. It just knows that it needs it and that its up to "},{"type":"codeVoice","code":"HomeDependencies"},{"type":"text","text":" to provide it."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The application, however, sees all, knows all, and can provide the missing cross-module dependency."}],"type":"paragraph"},{"syntax":"swift","code":["typealias AppDependencies = CoreDependencies","    & HomeDependencies","    & SettingsDependencies","","class AppResolver: AppDependencies {","    ...","    @MainActor func externalView() -> AnyView {","        \/\/ reach out to the settings module to provide the view needed","        SettingsDestinations.external.asAnyView()","    }","    ...","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Have I mentioned how powerful this technique is?"}],"type":"paragraph"}]}],"hierarchy":{"paths":[["doc:\/\/NavigatorUI\/documentation\/NavigatorUI"]]},"identifier":{"url":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/AdvancedDestinations","interfaceLanguage":"swift"},"schemaVersion":{"major":0,"minor":3,"patch":0},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/navigatorui\/advanceddestinations"]}],"metadata":{"role":"article","modules":[{"name":"NavigatorUI"}],"title":"Advanced Destinations","roleHeading":"Article"},"seeAlsoSections":[{"title":"Related Documentation","identifiers":["doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/Destinations"],"anchor":"Related-Documentation"},{"title":"Advanced Topics","identifiers":["doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/ProvidedDestinations"],"generated":true,"anchor":"Advanced-Topics"}],"references":{"doc://NavigatorUI/documentation/NavigatorUI":{"abstract":[{"text":"Managed NavigationStacks for SwiftUI.","type":"text"}],"type":"topic","kind":"symbol","url":"\/documentation\/navigatorui","identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI","title":"NavigatorUI","role":"collection"},"doc://NavigatorUI/documentation/NavigatorUI/Dismissible":{"type":"topic","role":"article","kind":"article","url":"\/documentation\/navigatorui\/dismissible","abstract":[{"text":"Understanding dismissible views and their role in application navigation and deep linking.","type":"text"}],"title":"Dismissible Views","identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/Dismissible"},"doc://NavigatorUI/documentation/NavigatorUI/Destinations":{"kind":"article","abstract":[{"text":"All navigation in Navigator is accomplished using enumerated values that conform to the NavigationDestination protocol.","type":"text"}],"role":"article","url":"\/documentation\/navigatorui\/destinations","title":"Destinations","type":"topic","identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/Destinations"},"doc://NavigatorUI/documentation/NavigatorUI/ProvidedDestinations":{"kind":"article","abstract":[{"type":"text","text":"Creating and using NavigationDestination’s when you don’t know the destination."}],"role":"article","url":"\/documentation\/navigatorui\/provideddestinations","title":"Navigation Provided Destinations","type":"topic","identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/ProvidedDestinations"},"doc://NavigatorUI/documentation/NavigatorUI/NavigationDestination":{"title":"NavigationDestination","identifier":"doc:\/\/NavigatorUI\/documentation\/NavigatorUI\/NavigationDestination","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"NavigationDestination"}],"url":"\/documentation\/navigatorui\/navigationdestination","fragments":[{"kind":"keyword","text":"protocol"},{"text":" ","kind":"text"},{"text":"NavigationDestination","kind":"identifier"}],"abstract":[{"text":"Provides enumerated navigation types than can be translated into Views.","type":"text"}],"role":"symbol","type":"topic"}}}